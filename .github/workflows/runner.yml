name: Network Bypass Runner
on:
  schedule:
    - cron: '0 */4 * * *' # اجرای خودکار هر ۴ ساعت برای پایداری ۲۴/۷ [۵۸۲]
  workflow_dispatch:      # امکان اجرای دستی در صورت قطع شدن [۵۸۳]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy Proxy Core
        run: |
          # دانلود و آماده‌سازی اسکریپت
          curl -Ls https://raw.githubusercontent.com/yonggekkk/argosbx/main/argosbx.sh -o argosbx.sh
          chmod +x argosbx.sh
          
          # اجرای اسکریپت با تنظیم متغیرهای حیاتی
          sudo -E ./argosbx.sh
          
          # زنده نگه داشتن رانر (بدون این خط، سرور خاموش و پروکسی قطع می‌شود)
          sleep infinity 
        env:
          vlpt: 2053                # پورت Reality [۶۷۰]
          argo: vwpt                # فعال‌سازی حتمی تونل آرگو (کلید حل مشکل پینگ) [۵۸۷، ۶۸۲]
          uuid: e69cc705-8d07-4131-8ec7-3b6e797207ff
          cf_token: ${{ secrets.CF_API_TOKEN }}
          cf_zone: ${{ secrets.CF_ZONE_ID }}
